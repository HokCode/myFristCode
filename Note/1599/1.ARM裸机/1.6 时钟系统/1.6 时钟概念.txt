1.6
	SoC时钟系统简介
	
		1.时钟的定义与意义
					
			(1)时钟是同步工作系统的同步节拍。
			
			(2)SoC内部有很多内部外设，这些内部外设需要一个同步的时钟系统来指挥他们协同工作。
			
		2.获得时钟
			
			(1)外部直接输入时钟信号(少用)
				
				SoC有个引脚来输入外部时钟信号。
				
			(2)外部晶振+内部时钟发生器
			
				大部分低频单片机都是这样工作的。
			
			(3)外部晶振+内部时钟发生器+内部PLL+内部分频器
			
				PLL：倍频，提高时钟频率。
				
				分频：因为各种内部外设频率都不同

			分析：
				S5PV210属于第三种。
					
					1.为什么不用外部高频晶振产生高频信号直接给CPU。
						
						芯片外部电路不适宜使用高频率，因为传导辐射比较难控制；高频率的晶振价格很高。所以不用第一种。
					
					2.为什么要内部先高频然后再分配。

						因为SpC内部有很多部件需要时钟，各自需要的时钟频率不同，没法统一供应。所以需要PLL后先得到一个最高频率(1GHz、1.2GHz)，然后各外设都有自己分频器分频得到自己想要的频率。
						
		3.时钟和系统性能的关系、超频、稳定性
			
			(1)一般SoC时钟频率都是可以认为编程控制的，频率的高低对系统性能有很大影响。

				1.S5PV210建议工作频率为800MHz~1.2GHz，一般都设置到1GHz主频。
			 
				2.如果设置到1.2GHz就是超频。超频时系统性能会提升，但是发热也会增大。因此会影响系统稳定性。
			
		4.时钟和外设编程的关联
			
			(1)每个外设工作都需要一定频率的时钟，这些时钟都是由时钟系统提供的。时钟系统可以编程控制工作模式，所以程序员可以为每个外设指定时钟来源、时钟分频系统，从而制动这个外设的工作时钟。
			
		5.时钟和功耗控制的关系
			
			(1)SoC中各种设备工作时，时钟频率越高，其功耗和发热量就越大，导致系统不稳定，所以需要的更好的散热条件。
			
			(2)SoC内部外设在不用时最好关掉，不然会浪费电。通过给某个外设断掉时钟，就可以关掉这个外设，让其不工作。
		
	S5PV210时钟系统简介
		
		1.时钟域：MSYS、DSYS、PSYS
			
			S5PV210时钟体系比较复杂，内部外设模块太多，因此把整个内部的时钟划分为3大块，叫做3个域。
		
			(1)MSYS
			
				CPU(cortex-A8内核)、DRAM控制器(DMC0和DMC1)、IRAM&IROM等等。
			
			(2)DSYS
				
				都是和视频显示、编解码等有关的模块。硬件解码。
			
			(3)PSYS
			
				和内部各种外设时钟有关，如：串口、SD接口、I2C、AC97(声卡)、USB等。
		
			分析：内部分为3个域的原因。
				
				因为210内部的这些模块彼此工作时钟速率差异较大，所以把高速的分在一起，低速的分在一起。
		
		2.时钟来源：晶振+时钟发生器+PLL+分频电路
			
			(1)
				S5PV210外部有4个晶振接口，设计板子硬件时可以根据需要来决定在哪里接晶振。接了晶振之后上电相应的模块就会产生震荡，产生原始(基本)钟。
				
				原始时钟再经过一系列的筛选开关进入相应的PLL电路生成倍频后的高频时钟。
		
				高频时钟再经过分频到达芯片内部各模块上。(有些模块内部还有进一步的分频器进行再次分频使用(串口模块))
		
		3.PLL：APLL、MPLL、EPLL、VPLL
			
			APLL：可以产生30MHz~1GHz。Cortex-A8、MSYS域  
		
			MPLL：可以产生50MHz~2GHz。DSYS域、PSYS域
			
			EPLL：可以产生10MHz~600MHz。DSYS域、PSYS域
			
			VPLL：可以产生10MHz~600MHz。Video视频相关模块。
		
	S5PV210时钟域详解
		
		1.MSYS域	
			
			ARMCLK：给CPU内核工作的时钟，主频。
		
			HCLK_MSYS：MSYS域的高频时钟。DMC0和DMC1使用。
			
			PCLK_MSYS：MSYS域的低频时钟。
				
			HCLK_IMEM：给iROM和iRAM(合称iMEM)。
			
		2.DSYS域
			
			HCLK_DSYS：DSYS域的高频时钟。
			
			PCLK_DSYS：DSYS域的低频时钟。
		
		3.PSYS域
			
			HCLK_PSYS：PSYS域的高频时钟。
			
			PCLK_PSYS：PSYS域的低频时钟。
			
			SCLK_ONENAND：
		
			总结：
			
				210内部的各个外设都是接在总线(内部AMBA总线)上的，AMBA总线有1条高频分支叫AHB，有一条低频分支叫APB。
			
				每个时间域都有对应的HCLK_XXX和PCLK_XXX。其中HCLK就是对应域中的AHB总线的工作频率；PLCK就是对应域中APB总线的工作频率。
			
				SoC内部的各个外设其实是挂在总线上工作的，外设的时钟来自于其挂在的总线。如串口UART挂在PSYS域下的APB总线上，因此串口的时钟来源是PCLK_PSYS。
		
		4.各时钟的典型值
			
				(1)当210刚上电时，默认是外部晶振+内部时钟发生器产生的24MHz频率的时钟直接给ARMCLK的，这时系统的主频就是24MHz,运行非常慢。
				
				(2)iROM代码执行时第6步初始化了时钟系统，这时给了系统一个默认推荐运行频率(工作性能和稳定性最佳的频率)。
		
				(3)各时钟的典型值：
				
					• freq(ARMCLK) 		= 1000 MHz
					• freq(HCLK_MSYS) 	= 200 MHz(DMC0、DMC1)
					• freq(PCLK_MSYS) 	= 100 MHz
					• freq(HCLK_IMEM) 	= 100 MHz

					• freq(HCLK_DSYS) 	= 166 MHz
					• freq(PCLK_DSYS) 	= 83 MHz
					 
					• freq(HCLK_PSYS)	= 133 MHz
					• freq(PCLK_PSYS)   = 66 MHz
					• freq(SCLK_ONENAND)= 133 MHz, 166 MHz
				
	S5PV210时钟体系框图详解(数据手册361)
		
		1.第一张图
			
			原始时钟->PLL倍频得到高频时钟->初次分频得到个总线时钟
		
		2.第二张图
			
			各中间时钟(第一张图中某个步骤生成的时钟)到各外设自己使用的时钟(个别外设自己再额外分频的设置)。
		
		3.重要符号
			
			MUX开关：或门。实际对应某个寄存器的某几个bit位的设置，设置值决定哪条通道是通的。	
			
			DIV分频器：硬件设备。可以对左边的频率进行n分频，分频后的低频时钟输出到右边。分频器在编程时实际对应某个寄存器的某几个bit位，可以通过设置对应bit位来设置分频器的分频系数。
			
			注：寄存器中的clock source x就是在设置MUX开关。
		
	S5PV210时钟设置的关键寄存器
		
		1.xPLL_LOCK
			
			主要是控制PLL锁定周期的。
		
		2.xPLL_CON/xPLL_CON0/XPLL_CON1
			
			PLL_CON寄存器主要用来打开/关闭PLL电路，设置PLL的倍频参数，查看PLL锁定状态。
			
		3.CLK_SRCn(n:0~6,6个)
			
			用来设置始终来源，对应时钟框图中的MUX开关(n选1)。
		
		4.CLK_SRC_MASKn	
			
			用于打开/关闭时钟源。他决定了开关n选1后是否能继续通过.默认都是打开的。
		
		5.CLK_DIVn	
			
			各模块的分频器参数配置。
		
		6.CLK_GATE_x
			
			在最后地方关闭时钟。(类似于CLK_SRC_MASK，但关闭的地方不相同)
			
		7.CLK_DIV_STASn、CLK_MUX_STASn
			
			分别用于查看DIV、MUX状态是已经完成(1)还是在进行中(0)。
		
		重要寄存器：xPLL_CON(倍频参数)、CLK_SRCn(MUX开关选哪一路)、CLK_DLVn(分频多少)
		
		